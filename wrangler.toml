name = "sitebuilder-agent"
main = "worker/index.js"
compatibility_date = "2026-02-24"

[[r2_buckets]]
binding = "seo_ai_apify_raw"
bucket_name = "seo-ai-apify-raw"

[[r2_buckets]]
binding = "CONVO_BUCKET"
bucket_name = "sitebuilder-convos"

[[d1_databases]]
binding = "DB"
database_name = "Onboarding_AI_Agent"
database_id = "6829390f-6695-4f75-8ebb-d367150981ca"

[ai]
binding = "AI"

[[services]]
binding = "INSPECTOR"
service = "sitebuilder-inspector"

[vars]
# Optional fallback if service binding is unavailable in your environment.
# Example: INSPECTOR_BASE_URL = "https://sitebuilder-inspector.<account>.workers.dev"
INSPECTOR_BASE_URL = "https://inspector.cardetailingreno.com"
    # Optional public base URL for demo HTML stored in R2.
    # Example: DEMO_PUBLIC_BASE_URL = "https://demo-cdn.sitebuilder1-03.pages.dev"
    DEMO_PUBLIC_BASE_URL = ""
    # Optional cache directives for generated demo HTML/assets in R2.
    DEMO_ASSET_CACHE_CONTROL = "public, max-age=31536000, immutable"
    DEMO_HTML_CACHE_CONTROL = "public, max-age=120"
    # Funnel CTA URLs for post-demo conversion actions.
    CONNECT_CLOUDFLARE_URL = "https://app.cardetailingreno.com/connect-cloudflare"
    MIGRATE_HOSTING_URL = "https://app.cardetailingreno.com/migrate-hosting"
    DUAL_SERVER_UPGRADE_URL = "https://app.cardetailingreno.com/upgrade/dual-server"
    UPGRADE_PAYPAL_URL = "https://app.cardetailingreno.com/upgrade/paypal"
    UPGRADE_CRYPTO_URL = "https://app.cardetailingreno.com/upgrade/crypto"
    FREE_VPS_BRIDGE_URL = "https://app.cardetailingreno.com/upgrade/free-vps-bridge"
    FREE_VPS_OFFER_WINDOW_DAYS = "30"
    PLUGIN_FREE_URL = "https://app.cardetailingreno.com/plugin-free"
TOLLDNS_URL = "https://app.cardetailingreno.com/tolldns-install"
GITHUB_SIGNUP_URL = "https://github.com/signup"
# Optional comma-separated extra frontend origins for CORS.
CORS_ALLOWED_ORIGINS = "https://app.cardetailingreno.com"
# Optional comma-separated blacklist overrides for reference-site filtering.
# REFERENCE_SITE_BLOCKLIST = "example.com,another-example.com"
# REFERENCE_SITE_BLOCKLIST_KEYWORDS = "news,entertainment"
# Monthly traffic threshold used as an upgrade signal.
UPGRADE_TRAFFIC_THRESHOLD = "2000"
# Optional public Turnstile site key for frontend challenge.
TURNSTILE_SITE_KEY = ""
# Optional WalletConnect Project ID for wallet login in the frontend.
WALLETCONNECT_PROJECT_ID = ""
# Optional internal key for /build/brief endpoint.
BUILD_BRIEF_DEBUG_KEY = ""
# Premium token metering config (SPL-ready).
PREMIUM_BUILDER_ENABLED = "true"
PREMIUM_WALLET_REQUIRED = "true"
PREMIUM_SPL_SYMBOL = "TOLLSPL"
PREMIUM_POINTS_ENABLED = "true"
PREMIUM_POINTS_SYMBOL = "PTS"
PREMIUM_FREE_TOKENS = "1200"
PREMIUM_FREE_POINTS = "800"
PREMIUM_TOKENS_PER_SPL = "1000"
PREMIUM_POINTS_PER_TOKEN = "1"
PREMIUM_BASE_COST_TOKENS = "180"
PREMIUM_PER_PAGE_COST_TOKENS = "90"
PREMIUM_PER_30_WORD_COST_TOKENS = "8"
PREMIUM_COMPLEXITY_UNIT_COST_TOKENS = "30"
# Optional hosted top-up page.
PREMIUM_TOPUP_URL = "https://app.cardetailingreno.com/premium/topup"
PREMIUM_POINTS_TOPUP_URL = "https://app.cardetailingreno.com/premium/points"
PREMIUM_POINTS_PACK_PRICE_USD = "9.99"
PREMIUM_POINTS_PACK_AMOUNT = "1200"
# Optional direct checkout URL for point packs (Stripe/merchant checkout).
PREMIUM_POINTS_CHECKOUT_URL = "https://app.cardetailingreno.com/premium/points/buy"
# Optional ad-reward points (rewarded after verified ad completion webhook).
PREMIUM_AD_REWARDS_ENABLED = "true"
PREMIUM_AD_REWARD_POINTS = "40"
PREMIUM_AD_REWARD_COOLDOWN_SEC = "300"

# Optional secret:
# wrangler secret put OPENAI_API_KEY
# Optional secret:
# wrangler secret put WP_PLUGIN_SHARED_SECRET
# Optional secret (for encrypting provider tokens in access vault):
# wrangler secret put CREDENTIAL_VAULT_KEY
# Optional secret:
# wrangler secret put TURNSTILE_SECRET_KEY
# Optional secret for signed point-credit webhook calls to /billing/points/credit:
# wrangler secret put PREMIUM_POINTS_WEBHOOK_SECRET
# Optional secret for signed ad-reward callbacks to /billing/points/ad/reward:
# wrangler secret put PREMIUM_AD_REWARD_WEBHOOK_SECRET
